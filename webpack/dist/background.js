(()=>{process.env.API_CLIENT_ID;const t=process.env.API_CLIENT_SECRET,e=["write_content","write_products","write_customers","write_orders","write_draft_orders"].join(","),n=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);function r(t){let e=t.match(/[#?](.*)/);return!e||!e.length<1?{}:new URLSearchParams(e[1].split("#")[0])}function o(e){return fetch(`https://${e.get("shop")}/admin/oauth/access_token`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({client_id:t,code:e.get("code")})})}chrome.runtime.onMessage.addListener(((t,i,s)=>(function(t){const r=`https://${t}/admin/oauth/authorize?${new URLSearchParams({client_id:e,redirect_url:chrome.identity.getRedirectURL(),state:n}).toString()}`;return chrome.identity.launchWebAuthFlow({interactive:!0,url:r})}(t.host).then(r).then(o).then((t=>t.json())).then(s),!0)))})();